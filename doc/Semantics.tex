\documentclass[10pt,twocolumn]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}

 
\usepackage{multicol}
\begin{document}

\section{Model-theoretic Semantics}

A Flix program $P = (C, L)$ is a set of constraints $C$ and a set of complete lattices $L$.

A constraint is a rule $A \Leftarrow A_1, \dots, A_n$ 
where $A$ is an \emph{atom} (called the \emph{head} of the rule) 
and $A_1, \dots, A_n$ are atoms (called the \emph{body} of the rule).
A fact is a rule with an empty body.
An atom is of the form $p_\ell(t_1, \dots, t_n)$ where 
$p$ is a predicate symbol,
$\ell \in L$ is the lattice associated with $p$, and
$t_1, \dots, t_n$ are terms. 
A term is either a wildcard variable, a named variable or a constant value\footnote{Note: Flix has no uninterpreted function symbols.}. 
The possible values are the unit value $()$, the booleans (\texttt{true}, \texttt{false}),
the integers (-5, 3, 7), tagged unions of values (e.g. \texttt{Tag} $v$) and 
tuples of values (e.g. $(1, \texttt{true}, 42)$).

A complete lattice $l \in L$ is a 6-tuple $l = (E, \bot, \top, \sqsubseteq, \sqcup, \sqcap)$ where 
$E$ is a set of elements $E \subseteq V$,
$\bot \in E$ is the least element,
$\top \in E$ is the greatest element,
$\sqsubseteq$ is the partial order on $E$,
$\sqcup$ is the least upper bound, and
$\sqcap$ is the greatest lower bound.

The \emph{Herbrand Universe} $\mathcal{U}$ of a Flix program $P$ is the set of all possible ground terms.
A ground term is non-wildcard, non-variable term. That is, the Herbrand Universe is exactly the set of values.

The \emph{Herbrand Base} $\mathcal{B}$ of $P$ is the set of all possible ground atoms whose
predicate symbols occur in $P$ and where the arguments are drawn from the Herbrand Universe.

We introduce a partial order on ground atoms. 
Given two ground atoms $A = p_\ell(v_1, \dots, v_n)$ and $B = p_\ell(v'_1, \dots, v'_n)$ with the same 
(i) predicate symbol, 
(ii) associated lattice and 
(iii) number of ground terms, we define their partial order as:
If $n = 1$ then $A \sqsubseteq B$ when $v_1 \sqsubseteq v_1'$.
If $n > 1$ then $A \sqsubseteq B$ when $v_1 = v_1', \dots, v_{n - 1} = v'_{n - 1}$ and $v_n \sqsubseteq v'_n$.

An interpretation $I$ of a Flix program $P$ is a subset of the Herbrand Base $\mathcal{B}$.
A ground atom $A$ is true w.r.t. an interpretation if $\exists A' \in I$ such that $A \sqsubseteq A'$. 
A conjunction of atoms $A_1, \cdots, A_n$ is true w.r.t. an interpretation if each atom is true in the interpretation.
A ground rule is true if either the body conjunction is false, or the head is true.

A model $M$ of $P$ is an interpretation that makes each ground instance of a each rule in $P$ true.

A model is \emph{compact} if it has no two ground atoms $A, A' \in M$ such that $A \sqsubseteq A'$.
%
A model is \emph{reduced} if it has no two ground atoms $A, A' \in M$ such that $A \sqsubseteq (A \sqcup A')$.
%
Finally, a model $M_1$ is \emph{minimal} if it is compact and reduced, and there is no other model $M_2$ 
such that there are two ground atoms $A \in M_1$ and $A' \in M_2$ where $A' \sqsubset A$.

\paragraph{Example.}
The Flix program $P$ with constraints:
\[
    A_\ell(\texttt{Even}) \quad A_\ell(\texttt{Odd}) \quad B_\ell(\texttt{Odd})
\]
and lattices $\{ \ell = (\bot, \top, \texttt{Even}, \texttt{Odd}\}, \sqsubseteq, \sqcup, \sqcap) \}$ has
the Herbrand Universe:
%
\[
    \mathcal{U} = \{\bot, \top, \texttt{Even}, \texttt{Odd}\}
\]
%
and the Herbrand Base: 
%
\begin{align*}
    \mathcal{B} = \{ & A_\ell(\bot), A_\ell(\texttt{Even}), A_\ell(\texttt{Odd}), A_\ell(\top), \\
                     & B_\ell(\bot), B_\ell(\texttt{Even}), B_\ell(\texttt{Odd}), B_\ell(\top) \}
\end{align*}
%
An interpretation of $P$ is a subset of $\mathcal{B}$.
For example,
%
\begin{align*}
    I_1 & = \{ A_\ell(\top) \} \\
    I_2 & = \{ A_\ell(\top), B_\ell(\bot) \} \\
    I_3 & = \{ A_\ell(\top), B_\ell(\texttt{Odd}), B_\ell(\top) \} \\
    I_4 & = \{ A_\ell(\texttt{Even}), A_\ell(\texttt{Odd}), B_\ell(\texttt{Odd}) \} \\
    I_5 & = \{ A_\ell(\top), B_\ell(\top) \} \\
    I_6 & = \{ A_\ell(\top), B_\ell(\texttt{Odd}) \}
\end{align*}
%
The interpretation 
$I_1$ is not a model of $P$ since it does not make $B_\ell(\texttt{Odd})$ true.
$I_2$ is also not a model of $p$ since it does not make $B_\ell(\texttt{Odd})$ true.
$I_3$ is a model of $p$, but it is not compact.
$I_4$ is a model of $p$, but it is not reduced.
$I_5$ is a model of $p$, it is compact and reduced, but it is not minimal as evidenced by $I_6$.

%\paragraph{Extension I: Monotone Filter Functions}

%\paragraph{Extension II: Monotone Functions in the Head}

%\paragraph{Proof: Existence of a Model.}

%\paragraph{Proof: Existence of a Finite Model.}

%\paragraph{Proof: Existence of a Unique Least Model.}

\end{document}


